<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>David&#39;s Sweet Hut</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="The blog of David Hu&#39;s">
<meta property="og:type" content="website">
<meta property="og:title" content="David&#39;s Sweet Hut">
<meta property="og:url" content="https://scefuvh.github.io/">
<meta property="og:site_name" content="David&#39;s Sweet Hut">
<meta property="og:description" content="The blog of David Hu&#39;s">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="David Hu">
<meta property="article:tag" content="Notes, Reviews, Essays">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="David&#39;s Sweet Hut" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">David&#39;s Sweet Hut</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://scefuvh.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-set的二三事" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/set%E7%9A%84%E4%BA%8C%E4%B8%89%E4%BA%8B/" class="article-date">
  <time datetime="2021-04-03T12:44:20.000Z" itemprop="datePublished">2021-04-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/set%E7%9A%84%E4%BA%8C%E4%B8%89%E4%BA%8B/">Set的二三事</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="set的二三事"><a href="#set的二三事" class="headerlink" title="set的二三事"></a>set的二三事</h1><p>在任何bash教程中, set命令总是被简单的放在”变量”一节中简单提及, 然后就消失无踪.<br>对于一个属于<code>find</code>, <code>tar</code>这样复杂强大的命令来说, 这无疑是焚琴煮鹤. 再考虑到它对<br>我们编写bash脚本所能作出的贡献, 损失就更大了.</p>
<p>因此, <code>set</code>值得花一篇文章的功夫详细讲述.</p>
<h2 id="所有人都知道的基本应用"><a href="#所有人都知道的基本应用" class="headerlink" title="所有人都知道的基本应用"></a>所有人都知道的基本应用</h2><p>最简单的, <code>set</code>会显示你的所有变量.</p>
<p><code>set a</code> 则会把a传给该shell实例的位置参数, <strong>并清空以前存在的</strong>.</p>
<h2 id="让bash更像编程语言—set的一些选项"><a href="#让bash更像编程语言—set的一些选项" class="headerlink" title="让bash更像编程语言—set的一些选项"></a>让bash更像编程语言—set的一些选项</h2><p>括号后面的为对应的选项名.</p>
<ul>
<li>-u: 当引用未定义的变量时, bash报错并退出.(nounset)</li>
<li>-e: 当引用不存在的命令时, bash报错并退出.(errexit)<br>  当然, 要是存在管道的话, 只有最后一个命令失败才会退出.<br>  因此我们有 <em>pipefail</em> 选项</li>
<li>-C: 当重定向命令要覆盖已存在的文件时, bash报错且文件不会被覆盖.(noclobber)</li>
<li>-x: 将正在执行的语句输出到标准错误流中.(xtrace).<br>  P.S.: 如果想要临时取消这个选项, 可以用<code>命令 || true</code>.</li>
</ul>
<h2 id="其他的奇怪选项"><a href="#其他的奇怪选项" class="headerlink" title="其他的奇怪选项"></a>其他的奇怪选项</h2><ul>
<li>-v: 将shell的输入输出到标准错误流中.</li>
<li>-f: 禁止路径扩展.(noglob)</li>
<li>-n: 试运行命令. 交互式shell下无效.(noexec)</li>
<li>-a: 所有变量定义都必须为全局.(allexport)</li>
<li>-o 设置名: 打开对应设置.<br>  某些没有对应选项的设置:<ul>
<li>pipefail: 上文已经提到过了, 当管道中任何一个命令执行失败时, 整个语句执行失败.</li>
<li>nolog: 禁止往历史写函数定义.</li>
<li>vi: 用vi模式编辑命令.</li>
<li>ignoreeof: 禁止<C-d>退出登录.</li>
</ul>
</li>
</ul>
<h2 id="支持UPU的shell的选项-比较复杂-目前尚未理解"><a href="#支持UPU的shell的选项-比较复杂-目前尚未理解" class="headerlink" title="支持UPU的shell的选项, 比较复杂, 目前尚未理解"></a>支持UPU的shell的选项, 比较复杂, 目前尚未理解</h2><ul>
<li>-b: (notify)</li>
<li>-h:</li>
<li>-m: (monitor)</li>
</ul>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>要想取消某个设置, 只要把对应的”-“改成”+”就行.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://scefuvh.github.io/set%E7%9A%84%E4%BA%8C%E4%B8%89%E4%BA%8B/" data-id="ckn1q9s5i00181eephqjtgh2a" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-npm使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/npm%E4%BD%BF%E7%94%A8/" class="article-date">
  <time datetime="2021-04-03T11:23:31.000Z" itemprop="datePublished">2021-04-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/npm%E4%BD%BF%E7%94%A8/">Npm使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="更新本地包"><a href="#更新本地包" class="headerlink" title="更新本地包"></a>更新本地包</h1><p><code>npm update</code><br><code>npm-check-update</code><br><code>ncu -u</code><br><code>npm install</code>  </p>
<h1 id="检查过时包"><a href="#检查过时包" class="headerlink" title="检查过时包"></a>检查过时包</h1><p><code>npm outdated</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://scefuvh.github.io/npm%E4%BD%BF%E7%94%A8/" data-id="ckn1q9s5d00111eep542w90kt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/npm/" rel="tag">npm</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-撰写Systemd文件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/%E6%92%B0%E5%86%99Systemd%E6%96%87%E4%BB%B6/" class="article-date">
  <time datetime="2021-03-31T16:00:00.000Z" itemprop="datePublished">2021-04-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/%E6%92%B0%E5%86%99Systemd%E6%96%87%E4%BB%B6/">撰写Systemd单元服务</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="文件路径与名字"><a href="#文件路径与名字" class="headerlink" title="文件路径与名字"></a>文件路径与名字</h2><p>在开始编写配置文件前, 我们需要先了解一下一些设定.</p>
<h3 id="文件存放路径"><a href="#文件存放路径" class="headerlink" title="文件存放路径"></a>文件存放路径</h3><p>Systemd从一下地方读取配置文件:</p>
<ul>
<li>/usr/lib/systemd/system/: 存放绝大部分配置文件.</li>
<li>/etc/systemd/system/: systemd启动时会默认执行的路径.</li>
<li>/usr/lib/sysemd/user/:</li>
<li>~/.local/share/systemd/user/</li>
<li>/etc/systemd/system/user:</li>
<li>~/.config/systemd/user/</li>
</ul>
<h3 id="名字约定"><a href="#名字约定" class="headerlink" title="名字约定"></a>名字约定</h3><p>配置文件名字只能由ASCII字母, 下划线和点组成.</p>
<p>末尾带有@的是模板服务, 子服务通过在@后添加内容作为值, 将模板服务实例化. 在模板中<br>代表那个值的字符为%i.</p>
<h2 id="编辑文件的道道"><a href="#编辑文件的道道" class="headerlink" title="编辑文件的道道"></a>编辑文件的道道</h2><p>因为包配置文件会经常更新, 所以直接修改包文件是个很蠢的办法.</p>
<p>为了能一劳永逸地完成修改, 我们有两种方式:</p>
<ul>
<li>在另一个地方覆盖原来的文件<br>  使用<code>systemctl edit --full</code>在/etc/systemd/system/中创建或打开对应的配置文件.<br>  如果设置了默认启动, 修改完后使用<code>systemctl reenable</code>重新链接新文件.</li>
<li>使用附加文件. 它们会附加到原文件的首部.<br>  使用<code>systemctl edit</code></li>
</ul>
<p>编辑完后, 相关服务必须重启才能让修改生效. 如果通过<code>systemctl edit</code>修改, 服务会自<br>动重启.</p>
<p>或者直接粗暴一点, <code>systemctl daemon-reload</code>重启所有单元.</p>
<p>提示:</p>
<ul>
<li>可以利用<code>systemd-delta</code>查看所有被覆盖和修改过的文件.</li>
<li>可以使用<code>systemctl cat</code>查看附加了附加文件的配置文件.</li>
</ul>
<h1 id="配置文件的编写"><a href="#配置文件的编写" class="headerlink" title="配置文件的编写"></a>配置文件的编写</h1><h2 id="Unit"><a href="#Unit" class="headerlink" title="Unit"></a>Unit</h2><h3 id="描述-Description"><a href="#描述-Description" class="headerlink" title="描述: Description"></a>描述: Description</h3><p>定义这个服务的综合描述.</p>
<h3 id="文档-Documentation"><a href="#文档-Documentation" class="headerlink" title="文档: Documentation"></a>文档: Documentation</h3><p>定义文档的位置, 如<code>man:sshd(8) man:sshd_config(5)</code>.</p>
<h3 id="依赖-Wants和Requires"><a href="#依赖-Wants和Requires" class="headerlink" title="依赖: Wants和Requires"></a>依赖: Wants和Requires</h3><p>Sytemd提供2种引入依赖的方式:</p>
<ul>
<li><code>Wants=</code>所依赖的服务名: 这种依赖是可选的, 即使所依赖的服务启动失败, 父服务<br>  也应该能正常执行.</li>
<li><code>Requires=</code>所依赖的服务名: 这种依赖是强制的.</li>
</ul>
<h4 id="执行顺序-After与Before"><a href="#执行顺序-After与Before" class="headerlink" title="执行顺序: After与Before"></a>执行顺序: After与Before</h4><p><strong>注意, 上面两种语句都不会强制要求子服务在父服务之前启动, 要强制做到这一点, 请使用 <code>after=要先启动的服务</code></strong>. 否则, 这些服务可能干脆并行启动. 相应地还有一个Before变量定义该服务在哪些服务前启动.</p>
<p>多个服务间用空格简单分开就好.</p>
<h3 id="冲突避免-Conflicts"><a href="#冲突避免-Conflicts" class="headerlink" title="冲突避免: Conflicts"></a>冲突避免: Conflicts</h3><p>定义会与该服务冲突的服务(组), 当变量里的服务(组)在运行时, 该服务不能运行.</p>
<h2 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h2><h3 id="环境变量文件-EnvironmentFile"><a href="#环境变量文件-EnvironmentFile" class="headerlink" title="环境变量文件: EnvironmentFile"></a>环境变量文件: EnvironmentFile</h3><p>定义当前服务的环境参数文件路径.</p>
<p>参数文件采用<code>键=值</code>的格式.</p>
<p>可以用<code>$键</code>在配置文件中引用.</p>
<h3 id="服务类型-Type"><a href="#服务类型-Type" class="headerlink" title="服务类型: Type"></a>服务类型: Type</h3><p>Systemd提供多种类型的服务满足不同场景下的使用. 服务类型通过Service一节的变量<br><code>Type</code>决定:</p>
<ul>
<li>simple: 默认值. Systemd会立刻启动该服务. ExecStart在主进程中执行命令. <strong>如果需要使用别的服务, 不要用这个类型.</strong><ul>
<li>idle: 基本同simple, 只是systemd会在其他服务都被调度妥当后才会执行. 一种场合是要让该服务的输出与其它服务分离开来.</li>
<li>notify: 基本与simple相同. 只是服务保证会适时地向systemd发信号.</li>
<li>dbug: 类似simple, 但是会等待DBus信号后启动.</li>
</ul>
</li>
<li>forking: ExecStart变量将会以分支进程的形式执行.</li>
<li>oneshot: 执行无死循环的程序并马上退出.</li>
</ul>
<h3 id="执行命令-Exec"><a href="#执行命令-Exec" class="headerlink" title="执行命令: Exec*"></a>执行命令: Exec*</h3><p>这个变量家族决定在什么时候执行什么样的命令, 在赋值符号后加一个”-“可以关闭错误输<br>出.</p>
<ul>
<li>ExecStart: 启动服务时执行的命令.</li>
<li>ExecReload: 重启服务时执行的命令.</li>
<li>ExecStop: 停止服务时执行的命令.</li>
<li>ExecStartPre: 启动服务前执行的命令.</li>
<li>ExecStartPost: 启动服务后执行的命令.</li>
<li>ExecStopPost: 停止服务后执行的命令.</li>
</ul>
<h3 id="终结方式-KillMode"><a href="#终结方式-KillMode" class="headerlink" title="终结方式: KillMode"></a>终结方式: KillMode</h3><p>定义Systemd如何停止服务.</p>
<ul>
<li>control-group: 杀死当前控制组里的所有进程.</li>
<li>process: 只杀死主进程. 经常被sshd等不希望停止服务后连接全断的服务使用.</li>
<li>mixed: 主进程收到SIGTREM, 子进程收到SIGKILL.</li>
<li>none: 执行ExecStop</li>
</ul>
<h3 id="重启相关-Restart-Sec"><a href="#重启相关-Restart-Sec" class="headerlink" title="重启相关: Restart(Sec)"></a>重启相关: Restart(Sec)</h3><p><code>Restart</code>定义退出后的重启方式.</p>
<p><code>RestartSec</code>定义重启前等待的秒数.</p>
<ul>
<li>no: 不重启</li>
<li>on-success: 仅在正常退出后重启.</li>
<li>on-failure: 仅在异常退出后重启. 守护进程常用.</li>
<li>on-adnormal: 仅在收到终止信号或超时后才重启.</li>
<li>on-abort: 仅在被未捕获信号终止后重启.</li>
<li>on-watchdog: 仅在超时退出后重启.</li>
<li>always: 总是重启.</li>
</ul>
<h3 id="执行者-User和Group"><a href="#执行者-User和Group" class="headerlink" title="执行者: User和Group"></a>执行者: User和Group</h3><h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><h3 id="划定服务组-WantedBy"><a href="#划定服务组-WantedBy" class="headerlink" title="划定服务组: WantedBy"></a>划定服务组: WantedBy</h3><p>定义该服务所在的服务组.</p>
<hr>
<h1 id="服务组"><a href="#服务组" class="headerlink" title="服务组"></a>服务组</h1><p>服务组表示一组服务,</p>
<p>服务组有单独的文件. 配置上基本与服务无异. 后缀名是target.</p>
<p>利用<code>systemd get-default</code>可以查看默认启动的服务组.</p>
<p>利用<code>systemctl list-dependencies</code> 可以查看某个服务或服务组的包含的服务.</p>
<p>利用<code>systemctl isolate</code> 可以切换到另一个服务组.</p>
<p>常用的服务组为multi-user.target和graphical.target, 后者依赖前者.</p>
<h1 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h1><p>就像服务组一样, 定时器也有自己的文件. 后缀名是timer.</p>
<p>文件配置也基本与普通服务相同. 最大的不同是多了一节Timer.</p>
<p>定时器的文件名字最好与一个已经存在服务的文件名字相同, 代表这个定时器管理那个服务. 当然, 我们也可以在timer一节中添加<code>Unit</code>变量指定一个名字不同的服务.</p>
<p>被管理的服务这下就不需要Install了, 因为定时器会帮它照料好.</p>
<p>概括说来, 有两种定时器:</p>
<ul>
<li>实时定时器: 使用变量<code>OnCalendar</code>. 在某一特定日期触发.<br>格式为DayOfWeek Year-Month-Day Hour:Minute:Second, “*”代表任意值, 用”上界..下界”代表一个区间, 用”,”连接多个可能值.<br>当然, 大家都懒, 像”daily”, “weekly”这样的简写也可以用.<br>想要知道自己时间究竟写对没有了吗? 运行<code>systemd-analyze calendar 时间</code>就可以知道下次<br>触发的时间了.<br>定时器只会在它启动的状态下触发. 要是该触发的时候没有启动, 那么这次触发就丢失了. 将<code>Persistent</code>变量赋值为真, 定时器在下次启动时就会补上遗漏的触发.</li>
<li>单调定时器: 使用变量家族<code>On类型Sec</code>, 在某时间发生了一个时间段后触发. 电脑关机<br>  或休眠的时间不计入.<br>  类型可以是:<ul>
<li>Boot</li>
<li>UnitActive</li>
<li>StartUp</li>
<li>Active</li>
<li>UnitInactive</li>
</ul>
</li>
</ul>
<p>要是担心多个任务同时唤醒会使得系统一下子变得很卡, <code>RandomizeDelaySec</code>可以在预订<br>时间上加一个不超过所给值的延迟.</p>
<h2 id="临时定时器"><a href="#临时定时器" class="headerlink" title="临时定时器"></a>临时定时器</h2><p>除了大动干戈的创建两个文件, systemd事实上提供了一种更为方便的临时定时器.</p>
<p><code>systemd-run --on-active=&quot;时间点或时间段&quot; 命令及参数......</code></p>
<p><code>systemd-run --on-active=&quot;时间点或时间段&quot; --unit 服务名</code></p>
<p>以上两种方式会临时性的创建一个定时器运行命令或服务.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://scefuvh.github.io/%E6%92%B0%E5%86%99Systemd%E6%96%87%E4%BB%B6/" data-id="ckn1q9s5l001e1eepdvolhefi" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Systemd/" rel="tag">Systemd</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Xiaoxin-Pad-Flashing" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/Xiaoxin-Pad-Flashing/" class="article-date">
  <time datetime="2021-02-19T07:35:06.440Z" itemprop="datePublished">2021-02-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Unlock-BootLoader"><a href="#Unlock-BootLoader" class="headerlink" title="Unlock BootLoader"></a>Unlock BootLoader</h1><ol>
<li>Enable <em>Unlock OEM Lock</em> in <em>Settings</em></li>
<li>Reboot to bootloader.</li>
<li>Execute <code>fastboot flashing unlock</code>.</li>
</ol>
<h1 id="Flash-TWRP"><a href="#Flash-TWRP" class="headerlink" title="Flash TWRP"></a>Flash TWRP</h1><ol>
<li>Execute <code>fastboot flash recovery twrp.img</code></li>
</ol>
<h1 id="Disable-Boot-Verification"><a href="#Disable-Boot-Verification" class="headerlink" title="Disable Boot Verification"></a>Disable Boot Verification</h1><ol>
<li><code>fastboot flash vbmetta vbmeta.img</code></li>
<li>Reboot into recovery.</li>
<li>Format <em>data</em> and clean</li>
</ol>
<h1 id="Flash-Magisk"><a href="#Flash-Magisk" class="headerlink" title="Flash Magisk"></a>Flash Magisk</h1><ol>
<li>Put magisk 21.4 to storage.</li>
<li>Install it in Recovery mode.</li>
<li>Reboot.</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://scefuvh.github.io/Xiaoxin-Pad-Flashing/" data-id="ckn1q9s58000p1eep7lzeevcq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-EarPhone-Failure" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/EarPhone-Failure/" class="article-date">
  <time datetime="2020-12-29T16:00:00.000Z" itemprop="datePublished">2020-12-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/EarPhone-Failure/">Ear Phone Can Not Be Recognized.</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><code>pacmd unload-module module-bluetooth-discover</code><br><code>pacmd unload-module module-bluetooth-policy</code><br><code>pacmd load-module module-bluetooth-discover</code><br><code>pacmd load-module module-bluetooth-policy</code></p>
<p>Restart bluetooth service and pulseaudio.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://scefuvh.github.io/EarPhone-Failure/" data-id="ckn1q9s4u00051eepe6a8a4sq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-zinit-installation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/zinit-installation/" class="article-date">
  <time datetime="2020-12-10T08:01:36.552Z" itemprop="datePublished">2020-12-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/zinit-installation/">Zinit_installation</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://scefuvh.github.io/zinit-installation/" data-id="ckn1q9s5k001c1eephrbx6vnr" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-M2-flashing" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/M2-flashing/" class="article-date">
  <time datetime="2020-10-27T16:13:19.335Z" itemprop="datePublished">2020-10-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/M2-flashing/">M2 Flashing</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>Downgrade the system to <em>update旧.zip</em></li>
<li>Root the device with kingroot.</li>
<li>Install <em>busybox</em> and a terminal.</li>
<li>Put <em>unlock_boootloader.sh</em> to <em>/sdcard</em>.</li>
<li>Run <em>busybox</em>.</li>
<li>Run <code>sh /sdcard/unlock_boootloader.sh</code>.</li>
<li>Connect the phone to the computer, and run <code>adb reboot bootloader</code> on computer.</li>
<li>Flash <em>twrp.img</em> to <em>recovery</em>.</li>
<li>Reboot to <em>recovery</em>.</li>
<li>Wipe <em>/cache</em>, <em>/data</em>, and <em>/system</em>.</li>
<li>Push a new system image to <em>/sdcard</em></li>
<li>Install it and reboot.</li>
<li>Have fun!</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://scefuvh.github.io/M2-flashing/" data-id="ckn1q9s4y000a1eep93bab1jd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux-Android/" rel="tag">Linux Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Piano-Setup" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/Piano-Setup/" class="article-date">
  <time datetime="2020-10-24T16:00:00.000Z" itemprop="datePublished">2020-10-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Piano-Setup/">Piano Setup</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Pre-setup"><a href="#Pre-setup" class="headerlink" title="Pre-setup"></a>Pre-setup</h1><p>Install <em>vmpk</em>, <em>fluidsynth</em>, <em>qsynth</em>, <em>timidity++</em> and <em>soundfont-fluid</em>.</p>
<h1 id="Setting-Up"><a href="#Setting-Up" class="headerlink" title="Setting Up"></a>Setting Up</h1><ol>
<li>Start <em>qsynth</em>, then click <em>Setup</em></li>
<li>Change <em>MIDI.MIDI Client Name ID(ALSA/CoreMidi)</em> to <em>Qsynth1</em></li>
<li>Change <em>Audio.Audio</em> Driver to <em>alsa</em>.</li>
<li>In <em>Soundfonts</em> section, add <em>/usr/share/soundfonts/FluidR3_GM.sf2</em> to the list.</li>
<li>Restart <em>qsynth</em></li>
<li>Start <em>vmpk</em>, then click <em>MIDI Connections</em></li>
<li>Change <em>Input MIDI Connection</em> to the empty</li>
<li>Click the “…” next to <em>MIDI OUT Driver</em>.</li>
<li>Change <em>Audio Driver</em> to <em>Alsa</em>.</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://scefuvh.github.io/Piano-Setup/" data-id="ckn1q9s53000h1eepalgk75n9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux-Music/" rel="tag">Linux Music</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Tomcat9-Install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/Tomcat9-Install/" class="article-date">
  <time datetime="2020-09-25T07:38:16.438Z" itemprop="datePublished">2020-09-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Tomcat9-Install/">Tomcat9 Install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>Install tomcat9</li>
<li>Add<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> &lt;role <span class="attribute">rolename</span>=<span class="string">&quot;tomcat&quot;</span>/&gt;</span><br><span class="line">&lt;role <span class="attribute">rolename</span>=<span class="string">&quot;manager-gui&quot;</span>/&gt;</span><br><span class="line">&lt;role <span class="attribute">rolename</span>=<span class="string">&quot;manager-script&quot;</span>/&gt;</span><br><span class="line">&lt;role <span class="attribute">rolename</span>=<span class="string">&quot;manager-jmx&quot;</span>/&gt;</span><br><span class="line">&lt;role <span class="attribute">rolename</span>=<span class="string">&quot;manager-status&quot;</span>/&gt;</span><br><span class="line">&lt;role <span class="attribute">rolename</span>=<span class="string">&quot;admin-gui&quot;</span>/&gt;</span><br><span class="line">&lt;role <span class="attribute">rolename</span>=<span class="string">&quot;admin-script&quot;</span>/&gt;</span><br><span class="line">&lt;user <span class="attribute">username</span>=<span class="string">&quot;tomcat&quot;</span> <span class="attribute">password</span>=<span class="string">&quot;[CHANGE_ME]&quot;</span> <span class="attribute">roles</span>=<span class="string">&quot;tomcat&quot;</span>/&gt;</span><br><span class="line">&lt;user <span class="attribute">username</span>=<span class="string">&quot;manager&quot;</span> <span class="attribute">password</span>=<span class="string">&quot;[CHANGE_ME]&quot;</span> <span class="attribute">roles</span>=<span class="string">&quot;manager-gui,manager-script,manager-jmx,manager-status&quot;</span>/&gt;</span><br><span class="line">&lt;user <span class="attribute">username</span>=<span class="string">&quot;admin&quot;</span> <span class="attribute">password</span>=<span class="string">&quot;[CHANGE_ME]&quot;</span> <span class="attribute">roles</span>=<span class="string">&quot;admin-gui&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>
in your <code>/etc/tomcat9/tomcat-users.xml</code></li>
<li>Change the group attributes of all files in <code>/usr/share/tomcat9/bin/</code> to <em>tomcat9</em>.</li>
<li>Run <code>systemctl edit tomcat9.service</code> and add the followint lines to the file:<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">User=tomcat9</span><br><span class="line">Group=tomcat9</span><br><span class="line">Environment=JAVA_HOME=<span class="variable">$&#123;TOMCAT_JAVA_HOME&#125;</span></span><br><span class="line"></span><br><span class="line">ExecStart=</span><br><span class="line">ExecStart=<span class="regexp">/usr/</span>lib<span class="regexp">/jvm/</span>default-runtime<span class="regexp">/bin/</span>java \</span><br><span class="line">            -Dcatalina.home=<span class="variable">$&#123;CATALINA_HOME&#125;</span> \</span><br><span class="line">            -Dcatalina.base=<span class="variable">$&#123;CATALINA_BASE&#125;</span> \</span><br><span class="line">            -Djava.io.tmpdir=<span class="regexp">/var/</span>tmp<span class="regexp">/tomcat9/</span>temp \</span><br><span class="line">            -cp <span class="regexp">/usr/</span>share<span class="regexp">/java/</span>commons-daemon.jar:<span class="regexp">/usr/</span>share<span class="regexp">/java/</span>eclipse-ecj.jar:<span class="variable">$&#123;CATALINA_HOME&#125;</span><span class="regexp">/bin/</span>bootstrap.jar:<span class="variable">$&#123;CATALINA_HOME&#125;</span><span class="regexp">/bin/</span>tomcat-juli.jar \</span><br><span class="line">            <span class="variable">$CATALINA_OPTS</span> \</span><br><span class="line">            org.apache.catalina.startup.Bootstrap</span><br><span class="line"></span><br><span class="line">ExecStop=</span><br><span class="line">ExecStop=<span class="regexp">/usr/</span>lib<span class="regexp">/jvm/</span>default-runtime<span class="regexp">/bin/</span>java \</span><br><span class="line">            -cp <span class="regexp">/usr/</span>share<span class="regexp">/java/</span>commons-daemon.jar:<span class="regexp">/usr/</span>share<span class="regexp">/java/</span>eclipse-ecj.jar:<span class="variable">$&#123;CATALINA_HOME&#125;</span><span class="regexp">/bin/</span>bootstrap.jar:<span class="variable">$&#123;CATALINA_HOME&#125;</span><span class="regexp">/bin/</span>tomcat-juli.jar \</span><br><span class="line">            stop org.apache.catalina.startup.Bootstrap</span><br></pre></td></tr></table></figure></li>
<li>You may add all commans in <code>/usr/share/tomcat9/bin</code> to <code>PATH</code>.</li>
<li>Start the service and enjoy.</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://scefuvh.github.io/Tomcat9-Install/" data-id="ckn1q9s55000m1eep015havs2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Install-Pintos-On-Archlinux" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/Install-Pintos-On-Archlinux/" class="article-date">
  <time datetime="2020-09-21T12:14:59.952Z" itemprop="datePublished">2020-09-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Install-Pintos-On-Archlinux/">Install Pintos on Archlinux</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Pintos is a small project to finish for system study. But it is very difficult for one linuxer to install it to their machine since it is way too old. The passage is mainly about installing pintos on archlinux with qemu.</p>
<h1 id="Get-Pintos"><a href="#Get-Pintos" class="headerlink" title="Get Pintos"></a>Get Pintos</h1><p><code>git clone git://pintos-os.org/pintos-anon</code></p>
<h1 id="Install-utility"><a href="#Install-utility" class="headerlink" title="Install utility"></a>Install utility</h1><ol>
<li>Since <em>stropts.h</em> no longer exists on modern linux, we must change dir to <code>$ROOTDIR/src/utils</code> and comment out <code>#include&lt;stropts.h&gt;</code> in <em>squish-pty.c</em> and <em>squish-unix.c</em> and lines 288-293 in <em>squish-pty.c</em></li>
<li>run <code>make</code></li>
</ol>
<h1 id="Compile-Pintos"><a href="#Compile-Pintos" class="headerlink" title="Compile Pintos"></a>Compile Pintos</h1><ol>
<li>Open <em>pintos-gdb</em> and change <em>GDBMACROS</em> to the absolute of your <em>gdb-macros</em>.</li>
<li>Compile the threads.</li>
<li>Edit <em>Make.vars</em>. Change the last line to ‘SIMULATOR = —qemu’</li>
<li>Compile the kernel</li>
<li>On line 103 of <em>pintos</em> file, change “bochs” to “qemu”. On line number 257 change “kernel.bin” to the relative path so that kernels of all projects can be run.</li>
<li>On line 362 of <em>pintos.pm</em> file, change <em>loader.bin</em> to the absolute path of it.</li>
<li>Happy experimenting!</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://scefuvh.github.io/Install-Pintos-On-Archlinux/" data-id="ckn1q9s4x00081eepddtn0ou4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Note/" rel="tag">Note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/System/" rel="tag">System</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Black-Apple/" rel="tag">Black Apple</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hardware/" rel="tag">Hardware</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux-Android/" rel="tag">Linux Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux-Music/" rel="tag">Linux Music</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/" rel="tag">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Note/" rel="tag">Note</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Notes/" rel="tag">Notes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Physics/" rel="tag">Physics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/System/" rel="tag">System</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Systemd/" rel="tag">Systemd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Test/" rel="tag">Test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/" rel="tag">npm</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/Black-Apple/" style="font-size: 10px;">Black Apple</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Hardware/" style="font-size: 10px;">Hardware</a> <a href="/tags/Linux/" style="font-size: 17.5px;">Linux</a> <a href="/tags/Linux-Android/" style="font-size: 10px;">Linux Android</a> <a href="/tags/Linux-Music/" style="font-size: 10px;">Linux Music</a> <a href="/tags/Math/" style="font-size: 12.5px;">Math</a> <a href="/tags/Note/" style="font-size: 10px;">Note</a> <a href="/tags/Notes/" style="font-size: 20px;">Notes</a> <a href="/tags/Physics/" style="font-size: 12.5px;">Physics</a> <a href="/tags/System/" style="font-size: 15px;">System</a> <a href="/tags/Systemd/" style="font-size: 10px;">Systemd</a> <a href="/tags/Test/" style="font-size: 10px;">Test</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/set%E7%9A%84%E4%BA%8C%E4%B8%89%E4%BA%8B/">Set的二三事</a>
          </li>
        
          <li>
            <a href="/npm%E4%BD%BF%E7%94%A8/">Npm使用</a>
          </li>
        
          <li>
            <a href="/%E6%92%B0%E5%86%99Systemd%E6%96%87%E4%BB%B6/">撰写Systemd单元服务</a>
          </li>
        
          <li>
            <a href="/Xiaoxin-Pad-Flashing/">(no title)</a>
          </li>
        
          <li>
            <a href="/EarPhone-Failure/">Ear Phone Can Not Be Recognized.</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 David Hu<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!--script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</body>
</html>